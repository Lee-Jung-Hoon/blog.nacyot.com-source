최근에 가장 핫한 자바스크립트 라이브러리를 꼽자면 단연 react.js를 꼽을 수 있습니다. react.js는 페이스북에서 개발중인 컴포넌트 기반 웹 어플리케이션을 도와주는 라이브러리입니다.

기존의 DOM 조작을 기반으로 해오던 클라이언트 사이드의 전통과 달리, 특정 상태에 기반에 돔 트리 전체를 재구축함으로써 특정 상태에 대한 단일한 뷰를 제공한다는 점을 특징으로 합니다.이러한 특징은 얼핏 보기에는 매우 비효율적으로 보입니다만, 내부적으로는 VirtualDom이라는 기술을 통해 효율적으로 구현되어있습니다.

구현도 구현이지만(실질적으로 컴포넌트 개발자가 VirtualDom 구현과 씨름할 일은 거의 없으니), 특정 상태에 대한 단일한 뷰를 구성한다는 특징은 어플리케이션의 내부 상태와 DOM 조작을 통해 변화되는 UI에 반영된 상태를 지속적으로 관리하기가 굉장히 어려웠던 클라이언트 개발에 매우 간단한 컴포넌트 모델을 제안합니다. react.js에서는 이를 컴포넌트 단위의 개발과 JSX라는 고유한 문법을 통해 지원합니다.

JSX는 얼핏 보기에도 기존의 템플릿 기반 개발과는 달리 컴포넌트 코드에 직접 HTML 코드(와 같은 무언가)가 삽입되는 퇴화한 듯한 형태를 하고 있습니다. 웹 프로그래밍에 성숙해감에 있어 HTML, 프로그래밍 로직, 스타일을 분리하는 것이 얼마나 강조되어왔는지는 두 말할 필요도 없습니다.

이러한 흐름에 역행하는 듯이 보이는 JSX는 좀 다른 관점에서 **관심의 분리**를 제안합니다. 실제로 JSX를 사용해 개발을 해보면 컴포넌트들을 정의하는 JSX의 XML-like한 문법이 실질적으로 기존의 웹 개발에서 사용하던 템플릿과는 다른 것임을 알 수 있습니다. 물론 겉보기나 표현 차원에서는 거의 완전히 같은 것이기 때문에, 이 말은 어폐가 있습니다만, 그럼에도 불구하고 생각해볼 여지가 있습니다.

먼저, react.js를 통해 만들어지는 컴포넌트는 기본적으로 단 하나의 요소 밖에 반환할 수 없습니다. 이는 XML-like한 요소들이 최종적으로는 javascript 코드로 변환된다는 사실을 생각해보면 비교적 쉽게 이해할 수 있습니다. 함수는 기본적으로 하나의 요소만을 반환할 수 있습니다. 물론 wrapping을 통해서 여러개의 요소를 반환하는 것은 가능합니다만, 이런 종류의 제한이 없는 템플릿의 접근 방법과는 분명한 차이가 있습니다.

두번째로 JSX의 컴포넌트들은 기본적으로 상태가 없이 개발되어야하기 때문입니다. 앞서 react.js 상태를 관리하는 새로운 모델을 제안한다고 이야기한 바 있습니다. 여기서 중요한 특징 중 하나는 react.js에서는 데이터가 상위 컴포넌트로부터 하위 컴포넌트로만 흐른다는 점입니다. 이 때 상위 컴포넌트는 state를 가지고, 하위 컴포넌트는 이 props(프로퍼티, html의 속성들)로 state에 의존적인 데이터들을 넘겨받습니다. 실제로 props와 state를 어떻게 관리할 지에 대한 제약은 없습니다만, 컴포넌트를 조합해서 만들어지는 최상위 컴포넌트(즉, react application)가 state를 가지고 이 state를 가지고 하위 컴포넌트들에게 props로 데이터를 전파하는 게 이상적입니다. 이런 식으로 컴포넌트를 구성하게 되면 하위 컴포넌트들에서는 별도의 state 관리 없이도 명시적으로 속성을 통해 넘겨받는 props 만으로 스스로 완결된 형태를 가질 수 있습니다. react.js를 통해서 개발하게 되는 대부분의 컴포넌트는 이와 같이 state를 가지지 않고 속성만을 통해서 정의됩니다. 이는 어디에 가지고 가서라도 사용할 수 있는 순수한 컴포넌트라고 할 수 있습니다.

정리합니다. 상태는 이러한 컴포넌트들을 구성한 최상위 컴포넌트(애플리케이션)만이 가집니다. 그리고 이 상태를 아래의 컴포넌트들로 전파합니다. 여기서 이야기하고 싶은 바는, 대부분의 컴포넌트에게 중요한 것은 넘겨받은 데이터를 어떻게 표현하는지만 알고 있으면 된다는 점입니다. XML-like한 표현은 바로 이를 위해서 존재합니다. 기존의 템플릿과 비교해보시기 바랍니다. 템플릿은 기본적으로 애플리케이션의 상태에 강하게 묶여있습니다. 템플릿은 어떤 상태에 의존적인지 알아야하고, 컨트롤러(혹은 다른 프로그래밍 로직) 또한 템플릿이 어떻게 생겼는지를 알아야하며, 따라서 강하게 얽혀있다고 할 수 있습니다.

JSX는 프로그래밍 코드에 HTML 코드를 끼워넣은 새로운 임베디드 기법이 아니라, 컴포넌트가 어떻게 표현되어야할 지를 정의한 프로그래밍 코드입니다. unobtrusive javascript에서 웹페이지 구조과 프로그래밍 로직과 스타일을 나누는 걸 권장했다고 한다면, JSX 내의 HTML Tag(와 비슷한 무언가)가 정말 웹페이저의 구조를 나타내는 건지 고민해볼 필요가 있습니다. JSX에서 XML-like한 문법을 직접 지원하는 것은 단순히 템플릿을 임베디드하고 싶었기 때문이 아니라, 자기 자신이 어떻게 표현되는 지를 정의하는 표현방식(즉, render 함수의 반환값) 자체를 컴포넌트의 UI 로직이 기술된 부분에 가장 가까이에 두고 싶었기 때문이라고 생각합니다. react.js의 모든 관심은 애플리케이션의 상태에 무관하게 정의된 컴포넌트 단위로 나눠집니다. 여기까지 놓고 보면 JSX의 선택은 대단히 합리적이라는 걸 알 수 있습니다. 난개발되던 구시대의 javascript나 php와는 차이가 있습니다.

이야기가 생각보다 길어졌습니다만, 이 글은 react.js를 소개하려는 글이지 설명하려는 글은 아닙니다.












































